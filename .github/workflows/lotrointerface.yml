name: run update_lotro_interface.py

on:
  workflow_dispatch:
    inputs:
      tag:
        description: 'Update'

jobs:
  build:
    runs-on: ubuntu-latest
    steps:

      - name: checkout repo content
        uses: actions/checkout@v2

      - name: Archive Release
        uses: thedoctor0/zip-release@master
        with:
          filename: 'Pets_${{ github.event.inputs.tag }}.zip'
          exclusions: '*.git* *.md *.py *.txt'

      - name: Upload Release
        uses: ncipollo/release-action@v1
        with:
          artifacts: 'Pets_${{ github.event.inputs.tag }}.zip'
          commit: master
          bodyFile: Release.md
          tag: ${{ github.event.inputs.tag }}
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: setup python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: install python packages
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: execute py script # run main.py
        env:
          MD5PASSWORD: ${{ secrets.MD5PASSWORD }}
        run: UPDATE=${{ github.event.inputs.tag }} python update_lotro_interface.py
